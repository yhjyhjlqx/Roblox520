name: Create Release

on:
  push:
    tags:
      - 'v*'  # 当推送v开头的标签时触发
  workflow_dispatch:  # 允许手动触发

jobs:
  build-release:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Prepare scripts package
        run: |
          mkdir -p release_package
          cp scripts/windows_update.ps1 release_package/
          cp scripts/macos_update.sh release_package/
          cp scripts/linux_update.sh release_package/
          cp hosts release_package/
          zip -r Roblox520_Scripts.zip release_package/
          
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: |
            Roblox520_Scripts.zip
          body: |
            ### Roblox520 脚本发布包
            
            包含以下文件：
            - Windows更新脚本 (windows_update.ps1)
            - macOS更新脚本 (macos_update.sh)
            - Linux更新脚本 (linux_update.sh)
            - 最新hosts文件
            
            使用说明请参考[README](https://github.com/${{ github.repository }}#使用方法)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
